---
// src/pages/asuntoremontit.astro
import Layout from "../../layouts/Layout.astro";
import Contactform from "../../components/Contactform.astro";
---

<Layout>
  <!-- HERO / INTRO -->
  <section class="bg-gray-300 text-gray-900 font-montserrat px-4 py-20">
    <div class="max-w-7xl mx-auto text-center space-y-6">
      <h1 class="text-4xl md:text-5xl font-bebas tracking-tight">
        Asuntoremontit
      </h1>
      <div class="max-w-3xl mx-auto space-y-4 text-base leading-relaxed">
        <p>
          Tarjoamme monipuoliset asuntoremonttipalvelut avaimet käteen
          -periaatteella. Teemme kaikenlaiset sisäremontit huolella ja sovitussa
          aikataulussa aina asiakkaan toiveita kuunnellen.
        </p>
        <p>
          Palveluihimme kuuluvat muun muassa: kalusteasennukset,
          lattia-asennukset, maalaus- ja pintakäsittelytyöt sekä seinäpintojen
          kunnostus ja tasoitetyöt.
        </p>
        <p>
          Laajan ja osaavan yhteistyöverkostomme kautta toteutamme myös
          kylpyhuoneremontit, sähkötyöt ja putkityöt.
        </p>
        <p>
          Olipa kyseessä pieni pintaremontti tai koko asunnon uudistus, hoidamme
          työn alusta loppuun laadukkaasti ja pidämme huolen, että lopputulos
          kestää aikaa ja käyttöä.
        </p>
      </div>
      <a
        href="#contact-scroll"
        class="inline-block bg-green-800 hover:bg-green-900 text-white font-bold text-lg py-4 px-8 rounded-full transition"
      >
        Pyydä tarjous asuntoremontista
      </a>
    </div>
  </section>

  <!-- GALLERY SECTION: Sisäremontit -->
  <section class="bg-gray-300 py-20 font-montserrat">
    <div class="max-w-[2000px] mx-auto px-4">
      <h2
        class="text-center text-3xl md:text-5xl font-bebas tracking-wide uppercase mb-12 text-gray-900"
      >
        Sisäremontit
      </h2>

      <!-- Scrollable image row -->
      <div
        class="overflow-x-auto whitespace-nowrap flex gap-6 pb-4 scroll-smooth"
      >
        <img
          src="/images/rem1.jpeg"
          alt="Sisäremontti – sisätilojen kunnostus"
          class="gallery-image w-[320px] h-[320px] object-cover rounded shadow-md flex-shrink-0 cursor-pointer"
          onclick="openModal('/images/rem1.jpeg')"
        />
        <img
          src="/images/rem2.jpeg"
          alt="Sisäremontti – moderni mustavalkoinen keittiö"
          class="gallery-image w-[320px] h-[320px] object-cover rounded shadow-md flex-shrink-0 cursor-pointer"
          onclick="openModal('/images/rem2.jpeg')"
        />
        <img
          src="/images/rem3.jpeg"
          alt="Sisäremontti – keittiöremontti selkeillä linjoilla"
          class="gallery-image w-[320px] h-[320px] object-cover rounded shadow-md flex-shrink-0 cursor-pointer"
          onclick="openModal('/images/rem3.jpeg')"
        />
        <img
          src="/images/rem4.jpeg"
          alt="Sisäremontti – vaalea skandinaavinen keittiö saarekkeella"
          class="gallery-image w-[320px] h-[320px] object-cover rounded shadow-md flex-shrink-0 cursor-pointer"
          onclick="openModal('/images/rem4.jpeg')"
        />
        <img
          src="/images/rem5.jpeg"
          alt="Sisäremontti – historiallinen porrashuone viimeisteltynä"
          class="gallery-image w-[320px] h-[320px] object-cover rounded shadow-md flex-shrink-0 cursor-pointer"
          onclick="openModal('/images/rem5.jpeg')"
        />
        <img
          src="/images/rem6.jpeg"
          alt="Sisäremontti – valko-musta moderni keittiö spottivaloilla"
          class="gallery-image w-[320px] h-[320px] object-cover rounded shadow-md flex-shrink-0 cursor-pointer"
          onclick="openModal('/images/rem6.jpeg')"
        />
        <img
          src="/images/rem7.jpeg"
          alt="Sisäremontti – perinteinen suomalainen sauna"
          class="gallery-image w-[320px] h-[320px] object-cover rounded shadow-md flex-shrink-0 cursor-pointer"
          onclick="openModal('/images/rem7.jpeg')"
        />
      </div>
    </div>

    <!-- Modal -->
    <div
      id="modal"
      class="fixed inset-0 bg-black/80 z-50 hidden justify-center items-center p-4"
    >
      <div class="relative max-w-4xl w-full">
        <button
          id="closeModal"
          class="absolute top-4 right-4 text-white text-2xl hover:text-gray-300 transition"
          aria-label="Sulje">✕</button
        >

        <!-- Prev / Next (mobile only) -->
        <button
          id="prevImage"
          class="md:hidden absolute left-2 top-1/2 -translate-y-1/2 text-white text-4xl font-bold px-2 hover:text-gray-300 transition"
          aria-label="Edellinen kuva">‹</button
        >
        <button
          id="nextImage"
          class="md:hidden absolute right-2 top-1/2 -translate-y-1/2 text-white text-4xl font-bold px-2 hover:text-gray-300 transition"
          aria-label="Seuraava kuva">›</button
        >

        <img
          id="modalImage"
          src=""
          alt="Näyttökuva"
          class="w-full max-h-[80vh] object-contain rounded-lg"
        />
      </div>
    </div>

    <!-- Script: mobile-only modal + prev/next + swipe; desktop clicks ignored -->
    <script type="module">
      const modal = document.getElementById("modal");
      const modalImage = document.getElementById("modalImage");
      const closeModalBtn = document.getElementById("closeModal");
      const prevBtn = document.getElementById("prevImage");
      const nextBtn = document.getElementById("nextImage");
      const images = [...document.querySelectorAll(".gallery-image")];

      let currentIndex = 0;
      const isMobile = () => window.matchMedia("(max-width: 768px)").matches;

      function openModalIndex(index) {
        if (!isMobile()) return; // ignore on desktop
        currentIndex = index;
        modalImage.src = images[currentIndex].getAttribute("src");
        modal.classList.remove("hidden");
        modal.classList.add("flex");
      }

      // keep inline onclicks working
      window.openModal = (src) => {
        if (!isMobile()) return;
        const idx = images.findIndex((img) => img.getAttribute("src") === src);
        openModalIndex(idx >= 0 ? idx : 0);
      };

      // also support clicking images directly
      images.forEach((img, i) => {
        img.addEventListener("click", () => openModalIndex(i));
      });

      function closeModal() {
        modal.classList.add("hidden");
        modalImage.src = "";
      }
      closeModalBtn.addEventListener("click", closeModal);
      modal.addEventListener("click", (e) => {
        if (e.target === modal) closeModal();
      });

      prevBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        currentIndex = (currentIndex - 1 + images.length) % images.length;
        modalImage.src = images[currentIndex].getAttribute("src");
      });
      nextBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        currentIndex = (currentIndex + 1) % images.length;
        modalImage.src = images[currentIndex].getAttribute("src");
      });

      // swipe support
      let startX = 0;
      modal.addEventListener(
        "touchstart",
        (e) => {
          startX = e.touches[0].clientX;
        },
        { passive: true },
      );
      modal.addEventListener("touchend", (e) => {
        const endX = e.changedTouches[0].clientX;
        const dx = endX - startX;
        if (Math.abs(dx) > 40) {
          if (dx > 0) prevBtn.click();
          else nextBtn.click();
        }
      });
    </script>
  </section>

  <!-- CONTACT FORM -->
  <Contactform />
</Layout>
